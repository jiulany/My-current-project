{"version":3,"sources":["webpack:///./src/pagesC/chat/chat.vue?05ef","webpack:///./src/pagesC/chat/chat.vue?6360","webpack:///./src/pagesC/chat/chat.vue?5055","webpack:///./src/pagesC/chat/chat.vue?73db","webpack:///./src/pagesC/chat/chat.vue","webpack:///./src/pagesC/chat/chat.vue?4e20","webpack:///./src/pagesC/chat/chat.vue?d7ad"],"names":["chatModel","ChatModel","data","no_pic","getApp","globalData","inputValue","message","receiver_id","user","is_online","robot","components","methods","_connectSocket","uni","connectSocket","url","_online","client_id","nick_name","avatar_url","user_id","id","message_type","online","then","res","console","log","_send","showLoading","title","params","sender_id","is_system_user","robotModel","sendModel","cutRobot","send","hideLoading","position","send_time","push","input","val","detail","value","onLoad","onShow","getStorageSync","self","onSocketOpen","onSocketError","onSocketClose","onSocketMessage","JSON","stringify","parse","type","vibrateLong","success","sendSocketMessage","onHide"],"mappings":"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","file":"pagesC/chat/chat.js","sourcesContent":["import { render, staticRenderFns } from \"./chat.vue?vue&type=template&id=042602f8&filter-modules=%7B%7D&\"\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\Users\\\\Administrator\\\\Desktop\\\\tgcb_uni_app\\\\tgcb_uni_app\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('042602f8')) {\n      api.createRecord('042602f8', component.options)\n    } else {\n      api.reload('042602f8', component.options)\n    }\n    module.hot.accept(\"./chat.vue?vue&type=template&id=042602f8&filter-modules=%7B%7D&\", function () {\n      api.rerender('042602f8', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pagesC/chat/chat.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=042602f8&filter-modules=%7B%7D&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nimport {ChatModel} from '../../model/chat.js'\r\nimport { setTimeout } from 'timers';\r\nconst chatModel = new ChatModel()\r\nexport default {\r\n  data() {\r\n    return {\r\n\t\tno_pic:getApp().globalData.no_pic,\r\n\t\tinputValue:\"\",\r\n\t\tmessage:[],\r\n\t\treceiver_id:1,\r\n    user:{},\r\n    is_online:false,\r\n    robot:false\r\n\t};\r\n  },\r\n  components: {},\r\n  methods: {\r\n    _connectSocket(){\r\n      uni.connectSocket({\r\n        url: \"wss://chatserver.tuogouchebao.com\",\r\n      });\r\n    },\r\n\t  _online(client_id,nick_name,avatar_url){\r\n\t\t  let data = {\r\n\t\t\t  user_id : \"user_\"+this.user.id,\r\n\t\t\t  client_id : client_id,\r\n\t\t\t  nick_name : nick_name,\r\n\t\t\t  avatar_url : avatar_url,\r\n\t\t\t  message_type : 1\r\n\t\t  }\r\n\t\t  chatModel.online(data).then((res) => {\r\n\t\t\tconsole.log(res)\r\n\t\t  })\r\n\t  },\r\n\t  _send()\r\n\t  {\r\n      uni.showLoading({\r\n        title:'loading'\r\n      })\r\n      let params = {\r\n        sender_id : \"user_\"+this.user.id,\r\n        receiver_id : \"system_\"+this.receiver_id,\r\n        message : this.inputValue,\r\n        avatar_url : 'avatar_url',\r\n        message_type : 1,\r\n        is_system_user:0\r\n      }\r\n      if(this.robot){\r\n        this.robotModel(params)\r\n      } else {\r\n        this.sendModel(params)\r\n      }\r\n      \r\n    },\r\n     cutRobot(){\r\n      uni.showLoading({\r\n        title:'loading'\r\n      })\r\n      this.robot = true;\r\n      let params = {\r\n        sender_id : \"user_\"+this.user.id,\r\n        receiver_id : \"system_\"+this.receiver_id,\r\n        message : 'robot',\r\n        avatar_url : 'avatar_url',\r\n        message_type : 1,\r\n        is_system_user:0\r\n      }\r\n      this.robotModel(params)\r\n\t  },\r\n    sendModel(params){\r\n        chatModel.send(params).then((res)=>{\r\n          uni.hideLoading()\r\n          console.log(res)\r\n          let data = res.data\r\n          params.position = 'right'\r\n          params.send_time = data.send_time\r\n          this.message.push(params)\r\n          this.inputValue = \"\"\r\n        })\r\n    },\r\n    robotModel(params){\r\n        chatModel.robot(params).then((res)=>{\r\n          uni.hideLoading()\r\n          console.log(res)\r\n          if (params.message == 'robot') {\r\n              this.inputValue = \"\"\r\n              return false\r\n          }\r\n          let data = res.data\r\n          params.position = 'right'\r\n          params.send_time = data.send_time\r\n          this.message.push(params)\r\n          this.inputValue = \"\"\r\n        })\r\n    },\r\n\t  input(val) {\r\n      this.inputValue = val.detail.value\r\n      console.log(val)\r\n\t  },\r\n  },\r\n  onLoad: function() {\r\n\r\n\t\r\n  },\r\n  onShow: function() {\r\n      this.user = uni.getStorageSync('users')\r\n      var self = this\r\n      this._connectSocket()\r\n      \r\n      uni.onSocketOpen(function(res) {\r\n          console.log(res);\r\n          console.log(\"打开成功\");\r\n      });\r\n\r\n      uni.onSocketError(function (res) {\r\n          console.log('WebSocket连接打开失败，请检查！');\r\n      });\r\n\r\n      uni.onSocketClose(function (res) {\r\n          self._connectSocket()\r\n          console.log('WebSocket 已关闭！');\r\n      });\r\n\r\n\r\n        uni.onSocketMessage(function(res) {\r\n        console.log(\"收到服务器信息\" + JSON.stringify(res));\r\n        let data = JSON.parse(res.data)\r\n        console.log(data)\r\n        switch(data.type){\r\n          case 'client_id':\r\n              self._online(data.client_id,'nick_name','avatar_url')\r\n          break;\r\n          case 'message':\r\n            let message = data\r\n            message.position = 'left'\r\n            setTimeout(()=>{\r\n              uni.vibrateLong({\r\n                success: function () {\r\n                    console.log('success');\r\n                }\r\n            });\r\n              self.message.push(message)\r\n            },1000)\r\n          break;\t  \r\n        }\r\n        \r\n      \r\n\r\n        });\r\n        uni.onSocketOpen(function(res) {\r\n          console.log(\"WebSocket连接已打开！\");\r\n          console.log(\"数据发送\");\r\n          uni.sendSocketMessage({\r\n            data: \"hello\"\r\n          });\r\n        });\r\n\r\n        \r\n  },\r\n  onHide: function() {}\r\n};\r\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1571283071844\n      var cssReload = require(\"C:/Users/Administrator/Desktop/tgcb_uni_app/tgcb_uni_app/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}